



Web Authorization Protocol                                   J. Lombardo
Internet-Draft                                                       AWS
Intended status: Informational                                A. Babeanu
Expires: 12 September 2025                                     IndieKite
                                                           11 March 2025


                   OAuth 2.0 client extension claims
          draft-lombardo-oauth-client-extension-claims-latest

Abstract

   This specification defines new claims for JWT profiled access tokens
   [RFC9068] so that resource providers can benefit from more granular
   information about the client: its authentication methods as long as
   the grant flow and the grant flow extensions used as part of the
   issuance of the associated tokens.

About This Document

   This note is to be removed before publishing as an RFC.

   The latest revision of this draft can be found at
   https://identitymonk.github.io/draft-lombardo-oauth-client-extension-
   claims/draft-lombardo-oauth-client-extension-claims.html.  Status
   information for this document may be found at
   https://datatracker.ietf.org/doc/draft-lombardo-oauth-client-
   extension-claims/.

   Discussion of this document takes place on the Web Authorization
   Protocol Working Group mailing list (mailto:oauth@ietf.org), which is
   archived at https://mailarchive.ietf.org/arch/browse/oauth/.
   Subscribe at https://www.ietf.org/mailman/listinfo/oauth/.

   Source for this draft and an issue tracker can be found at
   https://github.com/identitymonk/draft-lombardo-oauth-client-
   extension-claims.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 12 September 2025.

Copyright Notice

   Copyright (c) 2025 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction
   2.  Conventions and Definitions
   3.  JWT Access Token Client Extensions Data Structure
   4.  Requesting a JWT Access Token with Client Extensions
   5.  Security Considerations
   6.  IANA Considerations
     6.1.  Registry Content
       6.1.1.  Grant Type
       6.1.2.  Client Extensions
       6.1.3.  Client Authentication Context
       6.1.4.  Client Authentication Methods
   7.  References
     7.1.  Normative References
     7.2.  Informative References
   Acknowledgments
   Authors' Addresses

1.  Introduction

   Resource providers need information about the subject, the action,
   the resource, and the context involved in the request to be able to
   determine properly, with the help of a Policy Decision Point (PDP) or
   not, if a resource must be disclosed.

   When accessed with a JWT profiled access token [RFC9068] presented as
   a bearer token [RFC6750], a resource provider receives mainly
   information about the subject: - sub claim, - Any user profile claim
   set by the Authorization Server if applicable, - Any entitlement
   information if applicable, - Any metadata about the user class of
   authentication (acrclaim) or user methord of authentication (claim
   amr [RFC8176])

   The resource provider has very few information about the client,
   mainly in the form of the client_id [RFC8693] claim.

   This document defines 4 new claims allowing to describe more precise
   information about the client and metadata on how this client
   interacted with the authorization server during the issuance of the
   access token.

   The process by which the client interacts with the authorization
   server is out of scope.

2.  Conventions and Definitions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

   This specification uses the terms "access token", "authorization
   server", "authorization endpoint", "authorization request", "client",
   "protected resource", and "resource server" defined by "The OAuth 2.0
   Authorization Framework" [RFC6749].

3.  JWT Access Token Client Extensions Data Structure

   ## Client Authentication Information Claims ### Client Authentication
   Context claim TODO ### Client Authentication Method claim TODO ##
   Client Authorization Claims ### Grant Type claim TODO ### Client
   Extensions claim TODO

4.  Requesting a JWT Access Token with Client Extensions

   TODO # Validating JWT Access Tokens with Client Extensions TODO This
   specification follows the requirements of [RFC9068].

5.  Security Considerations

   TODO Security

6.  IANA Considerations

   ## Claims Registration TODO of this specification refers to the
   attributes "gty", "cxt", "ccr", and "cmr" to express client metadata
   JWT access tokens.  This section registers those attributes as claims
   in the "JSON Web Token (JWT)" IANA registry introduced in [RFC7519].

6.1.  Registry Content

6.1.1.  Grant Type

   Claim Name: gty Claim Description: Grant Type used Change Controller:
   IETF Specification Document(s): TODO of Draft

6.1.2.  Client Extensions

   Claim Name: cxt Claim Description: Client Extensions used for the
   Grant Type Change Controller: IETF Specification Document(s): TODO of
   Draft

6.1.3.  Client Authentication Context

   Claim Name: ccr Claim Description: Client Authentication Class
   Reference Change Controller: IETF Specification Document(s): TODO of
   Draft

6.1.4.  Client Authentication Methods

   Claim Name: cmr Claim Description: Client Authentication Methods
   Reference Change Controller: IETF Specification Document(s): TODO of
   Draft

7.  References

7.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/rfc/rfc2119>.

   [RFC6749]  Hardt, D., Ed., "The OAuth 2.0 Authorization Framework",
              RFC 6749, DOI 10.17487/RFC6749, October 2012,
              <https://www.rfc-editor.org/rfc/rfc6749>.

   [RFC6750]  Jones, M. and D. Hardt, "The OAuth 2.0 Authorization
              Framework: Bearer Token Usage", RFC 6750,
              DOI 10.17487/RFC6750, October 2012,
              <https://www.rfc-editor.org/rfc/rfc6750>.

   [RFC7519]  Jones, M., Bradley, J., and N. Sakimura, "JSON Web Token
              (JWT)", RFC 7519, DOI 10.17487/RFC7519, May 2015,
              <https://www.rfc-editor.org/rfc/rfc7519>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/rfc/rfc8174>.

   [RFC9068]  Bertocci, V., "JSON Web Token (JWT) Profile for OAuth 2.0
              Access Tokens", RFC 9068, DOI 10.17487/RFC9068, October
              2021, <https://www.rfc-editor.org/rfc/rfc9068>.

7.2.  Informative References

   [RFC7636]  Sakimura, N., Ed., Bradley, J., and N. Agarwal, "Proof Key
              for Code Exchange by OAuth Public Clients", RFC 7636,
              DOI 10.17487/RFC7636, September 2015,
              <https://www.rfc-editor.org/rfc/rfc7636>.

   [RFC8176]  Jones, M., Hunt, P., and A. Nadalin, "Authentication
              Method Reference Values", RFC 8176, DOI 10.17487/RFC8176,
              June 2017, <https://www.rfc-editor.org/rfc/rfc8176>.

   [RFC8693]  Jones, M., Nadalin, A., Campbell, B., Ed., Bradley, J.,
              and C. Mortimore, "OAuth 2.0 Token Exchange", RFC 8693,
              DOI 10.17487/RFC8693, January 2020,
              <https://www.rfc-editor.org/rfc/rfc8693>.

   [RFC8705]  Campbell, B., Bradley, J., Sakimura, N., and T.
              Lodderstedt, "OAuth 2.0 Mutual-TLS Client Authentication
              and Certificate-Bound Access Tokens", RFC 8705,
              DOI 10.17487/RFC8705, February 2020,
              <https://www.rfc-editor.org/rfc/rfc8705>.

   [RFC9101]  Sakimura, N., Bradley, J., and M. Jones, "The OAuth 2.0
              Authorization Framework: JWT-Secured Authorization Request
              (JAR)", RFC 9101, DOI 10.17487/RFC9101, August 2021,
              <https://www.rfc-editor.org/rfc/rfc9101>.

   [RFC9126]  Lodderstedt, T., Campbell, B., Sakimura, N., Tonge, D.,
              and F. Skokan, "OAuth 2.0 Pushed Authorization Requests",
              RFC 9126, DOI 10.17487/RFC9126, September 2021,
              <https://www.rfc-editor.org/rfc/rfc9126>.

   [RFC9396]  Lodderstedt, T., Richer, J., and B. Campbell, "OAuth 2.0
              Rich Authorization Requests", RFC 9396,
              DOI 10.17487/RFC9396, May 2023,
              <https://www.rfc-editor.org/rfc/rfc9396>.

   [RFC9449]  Fett, D., Campbell, B., Bradley, J., Lodderstedt, T.,
              Jones, M., and D. Waite, "OAuth 2.0 Demonstrating Proof of
              Possession (DPoP)", RFC 9449, DOI 10.17487/RFC9449,
              September 2023, <https://www.rfc-editor.org/rfc/rfc9449>.

Acknowledgments

   TODO acknowledge.

Authors' Addresses

   Jeff Lombardo
   AWS
   Email: jeff@authnopuz.xyz


   Alex Babeanu
   IndieKite
   Email: alex.babeanu@indykite.com
